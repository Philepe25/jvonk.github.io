<!DOCTYPE html>
<html lang="en-US">
    <head>
        <link rel="stylesheet" type="text/css" href="/assets/css/style.css">
        <link rel="stylesheet" type="text/css" href="/assets/css/site.css">
        <link rel="stylesheet" type="text/css" href="/assets/css/prism.css"><script type="text/javascript">
            let typeToName = {
                'pas': 'Pascal',
                'cpp': 'C++',
                'java': 'Java'
            }
            function getCode (type) {
                document.getElementById('code').innerHTML+="<div><br>"+(type=='java'?"<h2>CODE</h2>":"")+"<details><summary>"+typeToName[type]+"</summary><pre class = 'line-numbers language-" + (type=='pas'?'pascal':type) +"' data-src='"+"https://raw.githubusercontent.com/jvonk/USACO/master/Chapter_2/sort3/sort3".concat('.'+type)+"'></pre></details></div>";
            }
            document.addEventListener('DOMContentLoaded', function () {
                getCode('java');
                getCode('cpp');
                getCode('pas');
            });
        </script><meta charset="UTF-8"><!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Sorting a Three-Valued Sequence | Johan Vonk’s Website</title>
<meta name="generator" content="Jekyll v3.7.4" />
<meta property="og:title" content="Sorting a Three-Valued Sequence" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="You are given a sequence of key values (1, 2, 3). Write a program that computes the minimal number of exchange operations that are necessary to make the sequence sorted." />
<meta property="og:description" content="You are given a sequence of key values (1, 2, 3). Write a program that computes the minimal number of exchange operations that are necessary to make the sequence sorted." />
<link rel="canonical" href="https://jvonk.github.io/usaco/2018/10/08/sort3.html" />
<meta property="og:url" content="https://jvonk.github.io/usaco/2018/10/08/sort3.html" />
<meta property="og:site_name" content="Johan Vonk’s Website" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2018-10-08T18:00:00-07:00" />
<script type="application/ld+json">
{"url":"https://jvonk.github.io/usaco/2018/10/08/sort3.html","headline":"Sorting a Three-Valued Sequence","dateModified":"2018-10-08T18:00:00-07:00","datePublished":"2018-10-08T18:00:00-07:00","description":"You are given a sequence of key values (1, 2, 3). Write a program that computes the minimal number of exchange operations that are necessary to make the sequence sorted.","mainEntityOfPage":{"@type":"WebPage","@id":"https://jvonk.github.io/usaco/2018/10/08/sort3.html"},"@type":"BlogPosting","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<meta name="google-site-verification" content="a_1tMrUlVNqdFzDGwh_T1IpHoH9qeFrNoVkUBOmi9j0" />
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#157878">
        <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    </head>
    <body>
        <div class="navbar">
            <a href="https://jvonk.github.io">Home</a><a href="/about/">
                        About
                    </a><div class="dropdown">
                    <button class="dropbtn">
                        USACO</button>
                    <i class="fa fa-caret-down"></i>
                    <div class="dropdown-content"><div class="dropdown">
                                    <button class="dropbtn">CHAPTER 1<i class="fa fa-caret-down"></i>
                                    </button>
                                    <div class="dropdown-content">

        <div class="navbar"><div class="dropdown">
                                                <button class="dropbtn">Section 2<i class="fa fa-caret-down"></i>
                                                </button>
                                                <div class="dropdown-content"><a href="/usaco/2018/09/26/beads.html">beads -Broken Necklace
                                                            </a><a href="/usaco/2018/09/25/friday.html">friday -Friday the 13th
                                                            </a><a href="/usaco/2018/09/25/gift1.html">gift1 -Greedy Gift Givers
                                                            </a><a href="/usaco/2018/09/25/ride.html">ride -Your Ride Is Here
                                                            </a></div>
                                            </div><div class="dropdown">
                                                <button class="dropbtn">Section 3<i class="fa fa-caret-down"></i>
                                                </button>
                                                <div class="dropdown-content"><a href="/usaco/2018/09/28/dualpal.html">dualpal -Dual Palindromes
                                                            </a><a href="/usaco/2018/09/28/palsquare.html">palsquare -Palindromic Squares
                                                            </a><a href="/usaco/2018/09/28/namenum.html">namenum -Name That Number
                                                            </a><a href="/usaco/2018/09/28/transform.html">transform -Transformations
                                                            </a><a href="/usaco/2018/09/27/milk2.html">milk2 -Milking Cows
                                                            </a></div>
                                            </div><div class="dropdown">
                                                <button class="dropbtn">Section 4<i class="fa fa-caret-down"></i>
                                                </button>
                                                <div class="dropdown-content"><a href="/usaco/2018/09/30/skidesign.html">skidesign -Ski Course Design
                                                            </a><a href="/usaco/2018/09/29/wormhole.html">wormhole -Wormholes
                                                            </a><a href="/usaco/2018/09/29/combo.html">combo -Combination Lock
                                                            </a><a href="/usaco/2018/09/29/crypt1.html">crypt1 -Prime Cryptarithm
                                                            </a><a href="/usaco/2018/09/28/milk.html">milk -Mixing Milk
                                                            </a><a href="/usaco/2018/09/28/barn1.html">barn1 -Barn Repair
                                                            </a></div>
                                            </div><div class="dropdown">
                                                <button class="dropbtn">Section 5<i class="fa fa-caret-down"></i>
                                                </button>
                                                <div class="dropdown-content"><a href="/usaco/2018/10/02/milk3.html">milk3 -Mother's Milk
                                                            </a><a href="/usaco/2018/10/01/ariprog.html">ariprog -Arithmetic Progressions
                                                            </a></div>
                                            </div><div class="dropdown">
                                                <button class="dropbtn">Section 6<i class="fa fa-caret-down"></i>
                                                </button>
                                                <div class="dropdown-content"><a href="/usaco/2018/10/04/pprime.html">pprime -Prime Palindromes
                                                            </a><a href="/usaco/2018/10/03/sprime.html">sprime -Superprime Rib
                                                            </a><a href="/usaco/2018/10/03/numtri.html">numtri -Number Triangles
                                                            </a></div>
                                            </div></div>
                                    </div>
                                </div><div class="dropdown">
                                    <button class="dropbtn">CHAPTER 2<i class="fa fa-caret-down"></i>
                                    </button>
                                    <div class="dropdown-content">

        <div class="navbar"><div class="dropdown">
                                                <button class="dropbtn">Section 1<i class="fa fa-caret-down"></i>
                                                </button>
                                                <div class="dropdown-content"><a href="/usaco/2018/10/10/holstein.html">holstein -Healthy Holsteins
                                                            </a><a href="/usaco/2018/10/09/hamming.html">hamming -Hamming Codes
                                                            </a><a href="/usaco/2018/10/08/sort3.html">sort3 -Sorting a Three-Valued Sequence
                                                            </a><a href="/usaco/2018/10/08/castle.html">castle -The Castle
                                                            </a><a href="/usaco/2018/10/05/frac1.html">frac1 -Ordered Fractions
                                                            </a></div>
                                            </div><div class="dropdown">
                                                <button class="dropbtn">Section 2<i class="fa fa-caret-down"></i>
                                                </button>
                                                <div class="dropdown-content"><a href="/usaco/2018/10/12/lamps.html">lamps -Party Lamps
                                                            </a><a href="/usaco/2018/10/12/runround.html">runround -Runaround Numbers
                                                            </a><a href="/usaco/2018/10/11/subset.html">subset -Subset Sums
                                                            </a><a href="/usaco/2018/10/10/preface.html">preface -Preface Numbering
                                                            </a></div>
                                            </div><div class="dropdown">
                                                <button class="dropbtn">Section 3<i class="fa fa-caret-down"></i>
                                                </button>
                                                <div class="dropdown-content"><a href="/usaco/2018/10/17/concom.html">concom -Controlling Companies
                                                            </a><a href="/usaco/2018/10/17/money.html">money -Money Systems
                                                            </a><a href="/usaco/2018/10/15/zerosum.html">zerosum -Zero Sum
                                                            </a><a href="/usaco/2018/10/15/nocows.html">nocows -Cow Pedigrees
                                                            </a><a href="/usaco/2018/10/15/prefix.html">prefix -Longest Prefix
                                                            </a></div>
                                            </div><div class="dropdown">
                                                <button class="dropbtn">Section 4<i class="fa fa-caret-down"></i>
                                                </button>
                                                <div class="dropdown-content"><a href="/usaco/2018/10/31/fracdec.html">fracdec -Fractions to Decimals
                                                            </a><a href="/usaco/2018/10/31/cowtour.html">cowtour -Cow Tours
                                                            </a><a href="/usaco/2018/10/27/comehome.html">comehome -Bessie Come Home
                                                            </a><a href="/usaco/2018/10/22/maze1.html">maze1 -Overfencing
                                                            </a><a href="/usaco/2018/10/22/ttwo.html">ttwo -The Tamworth Two
                                                            </a></div>
                                            </div></div>
                                    </div>
                                </div><div class="dropdown">
                                    <button class="dropbtn">CHAPTER 3<i class="fa fa-caret-down"></i>
                                    </button>
                                    <div class="dropdown-content">

        <div class="navbar"><div class="dropdown">
                                                <button class="dropbtn">Section 1<i class="fa fa-caret-down"></i>
                                                </button>
                                                <div class="dropdown-content"><a href="/usaco/2018/11/06/inflate.html">inflate -Score Inflation
                                                            </a><a href="/usaco/2018/11/05/contact.html">contact -Contact
                                                            </a><a href="/usaco/2018/11/05/humble.html">humble -Humble Numbers
                                                            </a><a href="/usaco/2018/11/03/stamps.html">stamps -Stamps
                                                            </a><a href="/usaco/2018/11/01/agrinet.html">agrinet -Agri-Net
                                                            </a></div>
                                            </div><div class="dropdown">
                                                <button class="dropbtn">Section 2<i class="fa fa-caret-down"></i>
                                                </button>
                                                <div class="dropdown-content"><a href="/usaco/2018/12/11/msquare.html">msquare -Magic Squares
                                                            </a><a href="/usaco/2018/12/11/butter.html">butter -Magic Squares
                                                            </a><a href="/usaco/2018/11/15/spin.html">spin -Spinning Wheels
                                                            </a><a href="/usaco/2018/11/14/ratios.html">ratios -Feed Ratios
                                                            </a><a href="/usaco/2018/11/07/kimbits.html">kimbits -Stringsobits
                                                            </a><a href="/usaco/2018/11/07/fact4.html">fact4 -Factorials
                                                            </a></div>
                                            </div><div class="dropdown">
                                                <button class="dropbtn">Section 3<i class="fa fa-caret-down"></i>
                                                </button>
                                                <div class="dropdown-content"><a href="/usaco/2019/01/14/game1.html">game1 -A Game
                                                            </a><a href="/usaco/2019/01/12/camelot.html">camelot -Camelot
                                                            </a><a href="/usaco/2018/12/20/shopping.html">shopping -Shopping Offers
                                                            </a><a href="/usaco/2018/12/20/range.html">shopping -Shopping Offers
                                                            </a><a href="/usaco/2018/12/12/fence.html">fence -Riding the Fences
                                                            </a></div>
                                            </div><div class="dropdown">
                                                <button class="dropbtn">Section 4<i class="fa fa-caret-down"></i>
                                                </button>
                                                <div class="dropdown-content"><a href="/usaco/2019/01/28/rockers.html">rockers -Raucous Rockers
                                                            </a><a href="/usaco/2019/01/22/fence9.html">fence9 -Electric Fence
                                                            </a><a href="/usaco/2019/01/16/heritage.html">heritage -American Heritage
                                                            </a></div>
                                            </div></div>
                                    </div>
                                </div><div class="dropdown">
                                    <button class="dropbtn">CHAPTER 4<i class="fa fa-caret-down"></i>
                                    </button>
                                    <div class="dropdown-content">

        <div class="navbar"><div class="dropdown">
                                                <button class="dropbtn">Section 1<i class="fa fa-caret-down"></i>
                                                </button>
                                                <div class="dropdown-content"><a href="/usaco/2019/01/28/nuggets.html">nuggets -Beef McNuggets
                                                            </a></div>
                                            </div></div>
                                    </div>
                                </div></div>
                </div><div class="dropdown">
                    <button class="dropbtn">
                        PORTFOLIO</button>
                    <i class="fa fa-caret-down"></i>
                    <div class="dropdown-content"><a href="/portfolio/2018/11/23/overview.html">Overview
                                </a></div>
                </div></div>
        <header class="page-header" role="banner"><h1 class="project-name">
                    Sorting a Three-Valued Sequence</h1>
                    <div class="post-categories"><h2><a href="https://jvonk.github.io#USACO">USACO</a></h2></div><h2 class="project-tagline">
                        You are given a sequence of key values (1, 2, 3). Write a program that computes the minimal number of exchange operations that are necessary to make the sequence sorted.</h2><a href="https://github.com/jvonk/USACO/blob/master/Chapter_2/sort3/sort3.java" class="btn">Code on GitHub</a><br><a href="https://github.com/jvonk/jvonk.github.io/blob/master/_posts/2018-10-09-sort3.markdown" class="btn">Current Page on GitHub</a></header>
        <main id="content" class="main-content" role="main">
            <div class="realcontent"><a id="skip-to-content" href="#code">Skip to code</a><br><a id="skip-to-content2" href="#analysis">Skip to analysis</a><br><br>
                <em>This is a explanation of this problem from USACO's training website. I have converted it to markdown. Please do not just copy code; you will not learn anything; at least type it out and understand so you can do it yourself in the future!</em><p>Sorting is one of the most frequently performed computational tasks. Consider the special sorting problem in which the records to be sorted have at most <em>three</em> different key values. This happens for instance when we sort medalists of a competition according to medal value, that is, gold medalists come first, followed by silver, and bronze medalists come last.</p>

<p>In this task the possible key values are the integers 1, 2 and 3. The required sorting order is non-decreasing. However, sorting has to be accomplished by a sequence of exchange operations. An exchange operation, defined by two position numbers p and q, exchanges the elements in positions p and q.</p>

<p>You are given a sequence of key values. Write a program that computes the minimal number of exchange operations that are necessary to make the sequence sorted.</p>

<h3 id="program-name-sort3">PROGRAM NAME: sort3</h3>

<h3 id="input-format">INPUT FORMAT</h3>

<table>
  <tbody>
    <tr>
      <td><strong>Line 1:</strong></td>
      <td>N (1 &lt;= N &lt;= 1000), the number of records to be sorted</td>
    </tr>
    <tr>
      <td><strong>Lines 2-N+1:</strong></td>
      <td>A single integer from the set {1, 2, 3}</td>
    </tr>
  </tbody>
</table>

<h3 id="sample-input-file-sort3in">SAMPLE INPUT (file sort3.in)</h3>

<pre><code class="language-none">9
2
2
1
3
3
3
2
3
1
</code></pre>

<h3 id="output-format">OUTPUT FORMAT</h3>

<p>A single line containing the number of exchanges required</p>

<h3 id="sample-output-file-sort3out">SAMPLE OUTPUT (file sort3.out)</h3>

<pre><code class="language-none">4
</code></pre>

<div id="code"></div>
                <script src="/assets/js/prism.js"></script><br>
                <div id="analysis">
                    <h2>ANALYSIS</h2>
<details>
  <summary>
    <p>Russ Cox</p>
  </summary>

  <p>We read the input into an array, and sort a copy of it in another array, so we know what we have and what we want.</p>

  <p>A swap touches two elements, so it can correct at most two misplaced elements. We run through the array looking for pairs of misplaced elements that a swap would correct, and do those swaps.</p>

  <p>The remaining misplaced elements form little cycles: a 1 where a 2 should be, a 2 where a 3 should be, and that 3 where the 1 should be. It takes two swaps to correct such a cycle. So we count the number of such cycles (by counting misplaced elements and dividing by three) and then add in two times that many swaps.</p>

  <pre><code class="language-cpp">#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;string.h&gt;
#include &lt;assert.h&gt;

#define MAXN 	1000

int n;
int have[MAXN];
int want[MAXN];

int
intcmp(const void *a, const void *b)
{
    return *(int*)a - *(int*)b;
}

void
main(void)
{
    int i, j, k, n, nn[4], nswap, nbad;
    FILE *fin, *fout;

    fin = fopen("sort3.in", "r");
    fout = fopen("sort3.out", "w");
    assert(fin != NULL &amp;&amp; fout != NULL);

    fscanf(fin, "%d", &amp;n);

    for(i=0; i&lt;n; i++) {
	fscanf(fin, "%d", &amp;have[i]);
	want[i] = have[i];
    }
    qsort(want, n, sizeof(want[0]), intcmp);

    /* swaps that correct two elements */
    nswap = 0;
    for(i=0; i&lt;n; i++)
    for(j=0; j&lt;n; j++) {
	if(have[i] != want[i] &amp;&amp; have[j] != want[j]
	        &amp;&amp; have[i] == want[j] &amp;&amp; have[j] == want[i]) {
	    have[i] = want[i];
	    have[j] = want[j];
	    nswap++;
	}
    }

    /* remainder are pairs of swaps that correct three elements */
    nbad = 0;
    for(i=0; i&lt;n; i++)
	if(have[i] != want[i])
	    nbad++;

    assert(nbad%3 == 0);
    nswap += nbad/3 * 2;

    fprintf(fout, "%d\n", nswap);
    exit(0);
}
</code></pre>

</details>

<details>
  <summary>
    <p>Dan Jasper</p>
  </summary>

  <p>Dan Jasper from Germany writes:</p>

  <p>The previous solution needs a copy of the original list and O(N2) time. I think it was necessary with the original task, where you had to print out the exchange operations, but to just count them, there is a more efficient solution. You can count the “1”, “2” and “3”, so you can calculate in what parts (buckets) of the list they have to be. The rest of the solution is somehow equal to yours, but all in all it uses O(N) time and does not need a copy of the list.</p>

  <pre><code class="language-cpp">#include &lt;stdio.h&gt;

int list[1000], N, res, count[3], start[3];
in[3][3]; // this counts the number of "1"s in bucket "2", ...

void readFile() {
    FILE *f; int i;
    f = fopen("sort3.in", "r");
    fscanf(f, "%d", &amp;N);
    for(i = 0; i &lt; N; i++) {
        fscanf(f, "%d", &amp;list[i]);
    }
    fclose(f);
}

void writeFile() {
    FILE *f;
    f = fopen("sort3.out", "w");
    fprintf(f, "%d\n", res);
    fclose(f);
}

void findBuckets() {
    int i;
    for(i = 0; i &lt; N; i++) count[list[i]-1]++;
    start[0] = 0;
    start[1] = count[0];
    start[2] = count[0] + count[1];
}

void findWhere() {
    int i, j;
    for(i = 0; i &lt; 3; i++) {
        for(j = 0; j &lt; count[i]; j++) in[list[start[i] + j]-1][i]++;
    }
   }

void sort() {
    int h;
    // 1 &lt;-&gt; 2
    h = in[0][1];
    if(in[1][0] &lt; h) h = in[1][0];
    res += h; in[0][1] -= h; in[1][0] -= h;
    // 3 &lt;-&gt; 2
    h = in[2][1];
    if(in[1][2] &lt; h) h = in[1][2];
    res += h; in[2][1] -= h; in[1][2] -= h;
    // 1 &lt;-&gt; 3
    h = in[0][2];
    if(in[2][0] &lt; h) h = in[2][0];
    res += h; in[0][2] -= h; in[2][0] -= h;

    // Cycles
    res += (in[0][1] + in[0][2]) * 2;
}

void process() {
    findBuckets();
    findWhere();
    sort();
}

int main () {
    readFile();
    process();
    writeFile();
    return 0;
}
</code></pre>

</details>

<details>
  <summary>
    <p>Evgeni Dzhelyov</p>
  </summary>

  <p>Bulgaria’s Evgeni Dzhelyov writes:</p>

  <p>I read the elements one by one and count them, so we know exactly how 1s, 2s and 3s we have and we know how the sorted array looks like. Then I count the 2s in 1 and 1s in 2, so it is obvious that we need min(2sin1, 1sin2) swaps, I do the same for 1-3 and 2-3. The sum of all these mins give us the number of direct swaps we need. After that number of swaps we would have N 1s, 2s and 3s and we would need 2*N swaps, where N is max(2sin1, 1sin2) - min(2sin1, 1sin2).</p>

  <pre><code class="language-cpp">#include &lt;fstream&gt;

using namespace std;

int min (int a, int b) { return a &lt; b ? a : b; }
int max (int a, int b) { return a &gt; b ? a : b; }

int main () {
    int s[1024];
    int n;
    int sc[4] = {0};
    
    ifstream fin("sort3.in");
    ofstream fout("sort3.out");
    fin&gt;&gt;n;
    for (int i = 0; i &lt; n; i++) {
        fin&gt;&gt;s[i];
        sc[s[i]]++;
    }
    int s12 = 0, s13 = 0, s21 = 0, s31 = 0, s23 = 0, s32 = 0;
    for (int i = 0; i &lt; sc[1]; i++){
        if (s[i] == 2) s12++;
        if (s[i] == 3) s13++;
    }
    
    for (int i = sc[1]; i &lt; sc[1]+sc[2]; i++){
        if (s[i] == 1) s21++;
        if (s[i] == 3) s23++;
    }
    
    for (int i = sc[1]+sc[2]; i &lt; sc[1]+sc[2]+sc[3]; i++){
        if (s[i] == 1) s31++;
        if (s[i] == 2) s32++;
    }
    
    fout&lt;&lt;min(s12, s21)+min(s13, s31)+min(s23, s32) +
					2*(max(s12, s21) - min(s12, s21))&lt;&lt;endl;
    return 0;
}
</code></pre>

</details>

</div><br>
                <a id="skip-to-main" href="#content">Back to top</a></div><footer class="site-footer realcontent"><span class="site-footer-owner"><a href="https://github.com/jvonk/USACO/blob/master/Chapter_2/sort3/sort3.java">USACO - sort3</a>
                            is created by
                            <a href="http://github.com/jvonk">
                                jvonk</a>
                            .
                        </span></footer></main>
    </body>
</html>
